package com.fujitsu.edgewareroad.trivyutils.dto;

public class VulnerabilityScorePriorityThresholds {
    private Double minimumCVSS;
    private Double minimumEPSS;

    public VulnerabilityScorePriorityThresholds(Double minimumCVSS, Double minimumEPSS) {
        this.minimumCVSS = minimumCVSS;
        this.minimumEPSS = minimumEPSS;
    }

    public boolean supportsDeprioritisation()
    {
        return (minimumCVSS != null || minimumEPSS != null);
    }

    public boolean isPriorityForRemediation(double cvssScore, double epssScore)
    {
        if (!supportsDeprioritisation()) return true;   // All vulnerabilities must be prioritised
        return (cvssScore >= getMinimumCVSS()) && (epssScore >= getMinimumEPSS());
    }

    public Double getMinimumCVSS() {
        if (minimumCVSS != null) return minimumCVSS;
        return minimumEPSS != null ? 0.0 : null;
    }

    public Double getMinimumEPSS() {
        if (minimumEPSS != null) return minimumEPSS;
        return minimumCVSS != null ? 0.0 : null;
    }
}
